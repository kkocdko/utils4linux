#!/bin/sh
# if pidof chrome > /dev/null; then
# echo skip set text-scaling-factor
# else
# gsettings set org.gnome.desktop.interface text-scaling-factor 1
# nohup sh -c 'sleep 1.5 ; gsettings set org.gnome.desktop.interface text-scaling-factor 1.25' > /dev/null &
# sleep 0.1
# fi
cd /home/kkocdko/misc/apps/google-chrome
GTK_IM_MODULE=ibus GOOGLE_API_KEY=no GOOGLE_DEFAULT_CLIENT_ID=no GOOGLE_DEFAULT_CLIENT_SECRET=no exec $(dirname $0)/chrome \
--disable-crashpad-forwarding \
--disable-component-update \
--disable-breakpad \
--disable-logging \
--disable-speech-api \
--disable-domain-reliability \
--disable-smooth-scrolling \
--disable-nacl \
--disable-quic \
--disable-crash-reporter \
--disable-chrome-tracing-computation \
--disable-renderer-accessibility \
--disable-ax-menu-list \
--disable-top-sites \
--check-for-update-interval=315360000 \
--disable-features=TabHoverCardImages,EyeDropper,CustomizeChromeSidePanel,OptimizationGuideModelDownloading,AIPromptAPI,LanguageDetectionAPI,TranslationAPI,ExtensionManifestV2Unsupported,ExtensionManifestV2Disabled \
--password-store=basic \
--force-device-scale-factor=1 \
--gtk-version=4 \
--force-dark-mode \
--force-local-ntp \
--extension-mime-request-handling=always-prompt-for-install \
--use-gl=angle \
--use-angle=vulkan \
--enable-zero-copy \
--enable-features=WebUIDarkMode,FluentOverlayScrollbar,VaapiVideoDecodeLinuxGL,VaapiVideoEncodeLinuxGL,WebRTCPipeWireCapturer,Vulkan,VulkanFromANGLE,DefaultANGLEVulkan,VaapiIgnoreDriverChecks,VaapiVideoDecoder,VaapiVideoEncoder,UseMultiPlaneFormatForHardwareVideo,VaapiVideoEncodeAccelerator \
--google-api-key=no \
--google-url=http://example.com \
--google-apis-url=http://example.com \
--google-base-url=http://example.com \
--google-doodle-url=http://example.com \
--search-provider-logo-url=http://example.com \
--secure-connect-api-url=http://example.com \
--user-data-dir=/media/kkocdko/KK_TMP_1/home_config/google-chrome \
--disk-cache-dir=/media/kkocdko/KK_TMP_1/home_cache/google-chrome \
"$@"

# --enable-unsafe-webgpu
# --ignore-gpu-blocklist
# --enable-skia-graphite
# SkiaGraphite
# --optimization-guide-service-get-hints-url=http://example.com \
# --optimization-guide-service-get-models-url=http://example.com \

exit 1

cat <<EOF > /usr/share/applications/google-chrome.desktop
[Desktop Entry]
Version=1.0
Name=google-chrome
Exec=/home/kkocdko/misc/apps/google-chrome/main %U
Terminal=false
Type=Application
Categories=Network;WebBrowser;
MimeType=application/pdf;application/rdf+xml;application/rss+xml;application/xhtml+xml;application/xhtml_xml;application/xml;image/gif;image/jpeg;image/png;image/webp;text/html;text/xml;x-scheme-handler/http;x-scheme-handler/https;
EOF

# stable # 140.0.7339.185 (Official Build) unknown (64-bit)
mkdir google-chrome
cd google-chrome
curl -o google-chrome.deb -L https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
ar -p google-chrome.deb data.tar.xz | tar -xJ
mv opt/google/chrome/* .
rm -rf usr etc opt cron default_apps WidevineCdm MEIPreload PrivacySandboxAttestationsPreloaded CHROME_VERSION_* *.png *.xpm xdg-* liboptimization_guide_internal.so google-chrome chrome-management-service default-app-block
rm -rf locales/ml.pak locales/ta.pak locales/kn.pak locales/te.pak locales/hi.pak locales/bn.pak locales/gu.pak locales/mr.pak locales/th.pak locales/el.pak

# https://github.com/chromium/chromium/blob/141.0.7356.1/components/optimization_guide/core/optimization_guide_features.cc
# https://raw.githubusercontent.com/chromium/chromium/refs/tags/141.0.7348.1/gpu/config/gpu_switches.cc
# example.io
# google.com

# >>> chrome_crashpad_handler
# #!/bin/sh
# exec ./chrome_crashpad_handler_origin --database /media/kkocdko/KK_TMP_1/home_config/google-chrome-crash "$@"

